
{% if hostvars[item]['group_names'] | difference('monitoring_servers') %}
  # A host definition
object Host "{{ hostvars[item]['ansible_hostname'] }}" {
  import "generic-host"
  address = "{{ lookup('dns', item)  }}"
  vars.os = "{{ hostvars[item]['ansible_system'] }}"
  vars.os_family = "{{ hostvars[item]['ansible_os_family'] }}"
  vars.ssh_port = "{{ hostvars[item]['ansible_ssh_port'] }}"

  # Here Goes Vars and check_command
{% for key,value in host_attributes.iteritems() %}
{% for key,value in value.items() %}
  {{ key }} = "{{ value }}"
{% endfor %}
{% endfor %}

}

  #Here Goes Checks if Any
{% if host_checks is defined %}
{% for key,value in host_checks.iteritems() %}
{% set service_name = key %}

{% if service_name not in ['l_http', 'l_https', 'l_smtp', 'l_imaps']  %}
  # Service name not in special services
  object Service "{{ key }}" { 
    host_name = "{{ hostvars[item]['ansible_hostname'] }}"
  
    {% for key,value in value.items() %}
    {{ key }} = "{{ value  }}"
    {% endfor  %}
  }

{% else  %}

  object Service "{{ key }}" {
    # {{key}} - {{value}} - {{hostvars[item]['group_names']}}
    host_name = "{{ hostvars[item]['ansible_hostname'] }}"
	
    {% for key,value in value.items() %}   
    {% if key == 'check_command' and ((service_name == 'l_http' and 'monitored_http_servers' in hostvars[item]['group_names']) or (service_name == 'l_https' and 'monitored_https_servers' in hostvars[item]['group_names']) or (service_name == 'l_smtp' and 'monitored_smtp_servers' in  hostvars[item]['group_names'] ) or (service_name == 'l_imaps' and 'monitored_imaps_servers' in hostvars[item]['group_names'] )) %}

    # Special Service
    {{ key }} = "{{ value }}"
    
    {% endif  %}
    {% if key != 'check_command'  %}
    {{ key }} = "{{ value }}"
    {% endif  %}
	
    {% endfor %}
  }

{% endif  %}
    


{% endfor %}
{% endif %}
{% else %}
# This is a monitoring server entry. No checks will be copied.
{% endif %}
